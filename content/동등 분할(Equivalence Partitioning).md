동등 분할(Equivalence Partitioning 또는 Equivalence Class Partitioning, ECP)은 소프트웨어 테스팅에서 사용되는 블랙박스 테스트 케이스 설계 기법 중 하나입니다. 이 기법의 핵심 아이디어는 **입력 데이터의 전체 집합을 비슷한 방식으로 처리될 것으로 예상되는 부분 집합(동등 파티션 또는 동등 클래스)으로 나누고, 각 파티션에서 대표값 하나씩을 선택하여 테스트 케이스를 만드는 것**입니다.

만약 한 파티션 내의 특정 값으로 테스트했을 때 결함이 발견된다면, 그 파티션 내의 다른 값으로 테스트해도 동일한 결함이 발견될 가능성이 높다고 가정합니다. 반대로, 한 값이 성공적으로 처리된다면 다른 값들도 성공적으로 처리될 것이라고 가정합니다. 이를 통해 모든 가능한 입력 값을 테스트하는 대신, 훨씬 적은 수의 테스트 케이스로 효율적인 테스트 커버리지를 달성할 수 있습니다.

## 동등 분할의 원리

소프트웨어는 특정 조건이나 규칙에 따라 입력 값을 다르게 처리합니다. 동등 분할은 이러한 처리 방식이 동일하게 적용될 것으로 예상되는 입력 값들의 그룹을 찾는 것입니다.

예를 들어, 어떤 시스템이 18세 이상인 사용자에게만 특정 기능을 허용한다고 가정해 봅시다.

이 경우, 입력 값 '나이'에 대해 다음과 같은 동등 파티션을 식별할 수 있습니다:

1. **유효 동등 파티션**: 시스템이 정상적으로 받아들여 처리해야 하는 값들의 집합 (예: 18세 이상)
2. **무효 동등 파티션**: 시스템이 오류로 처리하거나 거부해야 하는 값들의 집합 (예: 18세 미만)

## 동등 분할을 통한 테스트 케이스 도출 방법

1. **입력 조건 식별**: 테스트 대상 시스템의 입력 값, 파라미터, 설정 등을 명확히 식별합니다.
2. **동등 파티션 정의**: 각 입력 조건에 대해 유효 동등 파티션과 무효 동등 파티션을 정의합니다.
    - **유효 동등 파티션**: 예상되는 입력 값, 정상적인 작동을 유도하는 값들의 그룹입니다. (예: "나이가 18에서 60 사이여야 한다"면, `[18, 60]` 범위의 값들)
    - **무효 동등 파티션**: 예상치 못한 입력 값, 오류를 유발하거나 시스템이 거부해야 하는 값들의 그룹입니다. (예: 위 예시에서 `나이 < 18` 또는 `나이 > 60`, 또는 숫자가 아닌 문자열 등)
3. **테스트 케이스 선택**: 각 동등 파티션에서 대표값을 하나씩 선택하여 테스트 케이스를 작성합니다. 일반적으로 파티션의 중간 값이나 임의의 값을 선택할 수 있습니다.

**예시 1: 사용자 이름 입력 (길이가 6~10자 사이의 영문자)**

- **입력 조건**: 사용자 이름 (문자열)
    
- **유효 동등 파티션**:
    
    - P1: 길이가 6자인 영문자 문자열 (예: "abcdef")
    - P2: 길이가 7~9자인 영문자 문자열 (예: "testing")
    - P3: 길이가 10자인 영문자 문자열 (예: "longuserId")
- **무효 동등 파티션**:
    
    - P4: 길이가 5자 이하인 영문자 문자열 (예: "user")
    - P5: 길이가 11자 이상인 영문자 문자열 (예: "verylonguserId")
    - P6: 숫자가 포함된 문자열 (예: "user123")
    - P7: 특수문자가 포함된 문자열 (예: "user!@#")
    - P8: 빈 문자열 (예: "")
    
    _(실제로는 P1, P2, P3를 하나의 유효 파티션 "길이가 6~10자인 영문자 문자열" (예: "username")으로 묶는 것이 더 일반적입니다. 이 경우, 경계 값 분석으로 경계(6, 10)를 테스트합니다.)_
    

**예시 2: 월(month) 입력 (1월부터 12월까지)**

- **입력 조건**: 월 (정수)
- **유효 동등 파티션**:
    - P1: 1부터 12 사이의 정수 (예: 7)
- **무효 동등 파티션**:
    - P2: 1보다 작은 정수 (예: 0, -5)
    - P3: 12보다 큰 정수 (예: 13, 20)
    - P4: 정수가 아닌 값 (예: "April", 3.14)

## 동등 분할의 장점

1. **테스트 케이스 수 감소**: 모든 가능한 입력 값을 테스트하는 대신 대표값만 사용하므로 테스트 케이스 수를 크게 줄여 시간과 노력을 절약할 수 있습니다.
2. **체계적인 테스트 커버리지**: 입력 조건의 다양한 유효 및 무효 시나리오를 체계적으로 커버할 수 있도록 도와줍니다.
3. **테스트 설계의 명확성**: 어떤 입력 값 그룹을 테스트해야 하는지 명확하게 정의해주므로 테스트 설계 과정을 단순화합니다.
4. **중복 테스트 방지**: 각 파티션에서 하나의 값만 선택하므로 동일한 로직을 불필요하게 반복 테스트하는 것을 막아줍니다.

## 동등 분할의 한계 및 고려사항

- **파티션 정의의 정확성**: 동등 파티션을 잘못 정의하면 중요한 결함을 놓칠 수 있습니다. 파티션 내의 모든 값이 실제로 동일하게 처리되는지 신중하게 판단해야 합니다.
- **경계 값의 중요성**: 동등 분할은 파티션 내의 임의의 값을 선택하므로, 오류가 자주 발생하는 경계 값을 놓칠 수 있습니다. 따라서 [[경계 값 분석(Boundary Value Analysis)]] 기법과 함께 사용하는 것이 매우 효과적입니다.
- **입력 값 간의 조합**: 동등 분할은 주로 개별 입력 조건에 초점을 맞춥니다. 여러 입력 값 간의 조합으로 인해 발생하는 복잡한 오류는 발견하기 어려울 수 있습니다. (이는 결정 테이블 테스팅이나 페어와이즈 테스팅과 같은 다른 기법으로 보완할 수 있습니다.)

## 동등 분할과 경계 값 분석의 관계

동등 분할과 경계 값 분석은 상호 보완적인 기법입니다.

1. **동등 분할**을 사용하여 입력 값의 전체 범위를 유효하고 무효한 파티션으로 나눕니다.
2. 그런 다음, **경계 값 분석**을 사용하여 각 파티션의 경계에 있는 값들을 테스트 케이스로 추가합니다.

이렇게 두 기법을 함께 사용하면, 적은 테스트 케이스로도 높은 결함 검출률을 기대할 수 있습니다.

## API 테스트에서의 활용

API 테스트 시, 요청 파라미터나 요청 본문(body)의 필드 값들에 대해 동등 분할을 적용할 수 있습니다.

예를 들어, 사용자를 생성하는 API가 `age` (나이), `userType` (사용자 유형: "admin", "general", "guest"), `email` (이메일 형식)과 같은 필드를 받는다고 가정해 봅시다.

- `age`: 유효 파티션 (예: 1~100), 무효 파티션 (예: 0 이하, 101 이상, 숫자 아닌 값)
- `userType`: 유효 파티션 ("admin", "general", "guest"), 무효 파티션 (예: "tester", 빈 문자열, null)
- `email`: 유효 파티션 (올바른 이메일 형식, 예: `user@example.com`), 무효 파티션 (형식에 맞지 않는 이메일, 예: `user@com`, `userexample.com`)

각 필드의 각 파티션에서 대표값을 선택하여 다양한 조합의 테스트 케이스를 생성하고, API가 각 케이스에 대해 예상대로 동작하는지(성공 또는 적절한 오류 메시지 반환) 검증합니다.

## 결론

동등 분할은 테스트해야 할 입력 값의 범위를 지능적으로 줄여 테스트 효율성을 극대화하는 기본적인 테스트 설계 기법입니다. 특히 경계 값 분석과 함께 사용될 때 그 효과가 배가되며, 다양한 종류의 소프트웨어 테스팅, 특히 API 테스팅에서 입력 값 유효성 검증에 널리 활용됩니다. 이를 통해 시스템의 다양한 입력 조건에 대한 견고성을 확보하는 데 중요한 역할을 합니다.